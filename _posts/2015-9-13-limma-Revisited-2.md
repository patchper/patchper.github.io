---
layout: post
title: limma Revisited, 2nd
tags: R limma
---

又过了一星期，懒癌发作的我终于记起来要把这东西写完……其实本周我实际尝试了一些*limma*和edgeR的复杂设计，感觉上周写的还是有不少缺陷，不过还是先把剩下的硬着头皮写完再说吧。

---

limma的思路始终是要按着这张综述的图片来：
![Summary]({{ site.baseurl }}/images/limma_overall.jpg )

上一次说到要对每个基因作一个线性模型，但是线性模型也只能对参数\\(\\hat\{\\beta\}\\)进行估计，还有一个非常重要的参数\\(s\_{g}\^{2}\*\\)需要估计。当然，我们可以对每个基因分别估计这个参数，有重复的就记为方差，没重复的就只好记为0，但是这样对于重复很少的实验来说非常吃亏，因为这样估计方差其自由度会非常低，在进行假设检验时会很不利。还有一个问题就是对方差本身的估计也不准确。在这个问题上，*limma*使用了经验贝叶斯建模的方法：

首先，假设所有基因的方差
